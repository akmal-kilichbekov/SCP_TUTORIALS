'use strict';
const
    deployer = require('./lib/deployer'),
    deployId = process.env.DEPLOY_ID || 'none';

function idle() {
    setTimeout(idle, 10 * 60 * 1000);
}

(async function deploy() {
    try {
        let msg = await deployer.deploy();
        //message that deploy service is listening to to know when deployment is finished or failed
        console.log(`Deployment of portal content done [Deployment Id: ${deployId}] , message: ${msg}`);
        idle();
    } catch (err) {
        console.error(`Deployment of portal content failed [Deployment Id: ${deployId}] , ${err.message}`);
        idle();
    }
})();
