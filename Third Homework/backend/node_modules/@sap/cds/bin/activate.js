module.exports = Object.assign(activate, {
    options: ['--username', '--passcode', '--subdomain', '--to', ],
    flags: ['--undeploy'],
    shortcuts: ['-u', '-p', '-s'],
    help: `
# SYNOPSIS

    *cds activate* [ <project> ] [ --to <url> ]

   Activate an extension project


# OPTIONS

    *-p* | *--passcode* <passcode>
    
        The passcode for authentication

    *-u* | *--username* <name> 

        Deprecated. Use passcode parameter instead.
        
    *--to* <url>
        The url to activate.
        
    *--undeploy* 
        Undeploy a previously deployed extension.
        
    *--skip-csrf*
        Skip fetching a csrf token before uploading the extension.           

`})


async function activate ([folder], options = {}) {
    try {
        const client = require('@sap/cds-sidecar-client')
        const askQuestion = client.question.askQuestion

        if (options.username && !options.passcode) {
            options.password = await askQuestion('Password: ', undefined, true)
        }

        const collectSources = require('../lib/models/cdsv').collectSources
        const cds = require('../lib/cds')

        const injection = {
            collectSources,
            cds
        };

        try {
            await client.apply(injection, folder, options)
        } catch (e) {
            console.error('\n[ERROR] Failed to activate extension\n\n' + e.message)
        }

    } catch (e) {
        console.log('This feature requires cds-sidecar-client to be installed')
    }

}



/* eslint no-console: off */
