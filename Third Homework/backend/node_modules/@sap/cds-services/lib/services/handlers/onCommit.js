module.exports = context => {
  if (!context._.connections) {
    return null
  }

  if (context._.connections.size === 1) {
    return context._.connections
      .values()
      .next()
      .value.commit()
  }

  const commits = []

  for (const transaction of context._.connections.values()) {
    commits.push(transaction.commit())
  }

  return Promise.all(commits)
}
